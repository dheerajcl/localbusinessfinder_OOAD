<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{fragments :: headerfiles(title=${pageTitle})}"></head>
<body>
<nav th:replace="~{fragments :: navbar}"></nav>
<div class="content-wrapper">
    <div class="container mt-5">
        <h2 th:text="${pageTitle}">Business Form</h2>
        <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"></div>

        <form th:action="${businessDto.id == null ? '/admin/business' : '/admin/business/update'}"
              th:object="${businessDto}" method="post" class="needs-validation row g-3" novalidate>

            <!-- Hidden ID field for updates -->
            <input type="hidden" th:field="*{id}" />

            <div class="col-md-6">
                <label for="name" class="form-label">Business Name:</label>
                <input type="text" id="name" th:field="*{name}" class="form-control" th:errorclass="is-invalid" required>
                <div class="invalid-feedback" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></div>
            </div>
            <div class="col-md-6">
                <label for="category" class="form-label">Category:</label>
                <input type="text" id="category" th:field="*{category}" class="form-control" th:errorclass="is-invalid" required>
                 <div class="invalid-feedback" th:if="${#fields.hasErrors('category')}" th:errors="*{category}"></div>
            </div>

            <div class="col-12">
                <label for="description" class="form-label">Description:</label>
                <textarea id="description" th:field="*{description}" class="form-control" rows="4" th:errorclass="is-invalid"></textarea>
                <div class="invalid-feedback" th:if="${#fields.hasErrors('description')}" th:errors="*{description}"></div>
            </div>

            <div class="col-12">
                <label for="address" class="form-label">Address:</label>
                <input type="text" id="address" th:field="*{address}" class="form-control" th:errorclass="is-invalid" required>
                 <div class="invalid-feedback" th:if="${#fields.hasErrors('address')}" th:errors="*{address}"></div>
            </div>
             <div class="col-md-5">
                <label for="city" class="form-label">City:</label>
                <input type="text" id="city" th:field="*{city}" class="form-control" th:errorclass="is-invalid" required>
                 <div class="invalid-feedback" th:if="${#fields.hasErrors('city')}" th:errors="*{city}"></div>
            </div>
             <div class="col-md-3">
                <label for="state" class="form-label">State (2 Letters):</label>
                <input type="text" id="state" th:field="*{state}" class="form-control" maxlength="2" th:errorclass="is-invalid" required>
                 <div class="invalid-feedback" th:if="${#fields.hasErrors('state')}" th:errors="*{state}"></div>
            </div>
             <div class="col-md-4">
                <label for="zip" class="form-label">Zip Code:</label>
                <input type="text" id="zip" th:field="*{zip}" class="form-control" th:errorclass="is-invalid" required>
                 <div class="invalid-feedback" th:if="${#fields.hasErrors('zip')}" th:errors="*{zip}"></div>
            </div>

             <div class="col-md-6">
                <label for="phone" class="form-label">Phone:</label>
                <input type="tel" id="phone" th:field="*{phone}" class="form-control" th:errorclass="is-invalid">
                <div class="invalid-feedback" th:if="${#fields.hasErrors('phone')}" th:errors="*{phone}"></div>
            </div>
             <div class="col-md-6">
                <label for="tollFree" class="form-label">Toll-Free (Optional):</label>
                <input type="tel" id="tollFree" th:field="*{tollFree}" class="form-control" th:errorclass="is-invalid">
                 <div class="invalid-feedback" th:if="${#fields.hasErrors('tollFree')}" th:errors="*{tollFree}"></div>
            </div>

             <div class="col-md-6">
                <label for="priceRange" class="form-label">Price Range:</label>
                <select id="priceRange" th:field="*{priceRange}" class="form-select" th:errorclass="is-invalid" required>
                     <option value="">-- Select --</option>
                     <option value="1">$ (Affordable)</option>
                     <option value="2">$$ (Moderate)</option>
                     <option value="3">$$$ (Expensive)</option>
                </select>
                 <div class="invalid-feedback" th:if="${#fields.hasErrors('priceRange')}" th:errors="*{priceRange}"></div>
            </div>
             <div class="col-md-6">
                <label for="advanceAmount" class="form-label">Advance Payment Required:</label>
                <div class="input-group">
                    <span class="input-group-text">$</span>
                     <input type="number" id="advanceAmount" th:field="*{advanceAmount}" class="form-control" step="0.01" min="0" th:errorclass="is-invalid" required>
                     <div class="invalid-feedback" th:if="${#fields.hasErrors('advanceAmount')}" th:errors="*{advanceAmount}"></div>
                 </div>
            </div>

            <div class="col-12 mt-4">
                <button type="submit" class="btn btn-primary" th:text="${businessDto.id == null ? 'Add Business' : 'Update Business'}">Submit</button>
                <a th:href="@{/admin/dashboard}" class="btn btn-outline-secondary ms-2">Cancel</a>
            </div>
        </form>
    </div>
</div>
<footer th:replace="~{fragments :: footer}"></footer>
</body>
</html>